# request.security

`request.security` یکی از توابع پیشرفته در Pine Script است که به شما امکان می‌دهد داده‌ها یا محاسبات یک نماد (`symbol`) یا تایم‌فریم (`timeframe`) دیگر را به اسکریپت خود بیاورید.

نماد یا شناسه تیکر داده‌های درخواستی. برای داده های نمودار فعلی، از یک رشته خالی یا `syminfo.tickerid` استفاده کنید. برای بازیابی داده‌ها با اصلاح‌کننده‌های اضافی (مانند جلسات توسعه‌یافته، تعدیلات سود سهام، انواع نمودار غیرمعمول مانند هیکن‌اشی و رنکو و غیره)، یک شناسه تیکر سفارشی برای درخواست با استفاده از توابع موجود در فضای نام `*.ticker` ایجاد کنید.
## Syntax:

```pine
request.security(symbol, timeframe, expression, gaps, lookahead, ignore_invalid_symbol, currency, calc_bars_count) → series <type>

```

## symbol (series string)

نام نماد مورد نظر است.

برای نماد فعلی از `syminfo.tickerid` استفاده شود.

**مثال:**
فرض کنید می‌خواهید میانگین متحرک ساده (SMA) نماد فعلی را در تایم‌فریم روزانه روی تایم‌فریم فعلی رسم کنید:

```pine
//@version=6
indicator("Daily SMA", overlay=true)

// درخواست SMA از تایم‌فریم روزانه
daily_sma = request.security(syminfo.tickerid, "D", ta.sma(close, 14))

// رسم SMA
plot(daily_sma, color=color.blue, title="Daily SMA")

```

## *.ticker

استفاده از داده های انواع دیگر نمودار:

**مثال:**
برای دریافت اطلاعات رنکو چارت (Renko Chart) فعلی در Pine Script، باید از فضای نام `*.ticker` استفاده کنید و شناسه نماد را به‌صورت سفارشی برای رنکو تعریف کنید. با استفاده از تابع `ticker.renko` می‌توانید اطلاعات رنکو را درخواست کنید.

فرض کنید می‌خواهید قیمت بسته شدن (close) و باز شدن (open) رنکو برای نماد فعلی را بازیابی و رسم کنید


```pine
//@version=6
indicator("Renko Bricks on Candles", overlay=true)

// ایجاد شناسه رنکو برای نماد فعلی
renko_ticker = ticker.renko(syminfo.tickerid,"ATR",14)

// دریافت قیمت باز و بسته آجرهای رنکو
renko_open = request.security(renko_ticker, timeframe.period, open)
renko_close = request.security(renko_ticker, timeframe.period, close)

// رسم خطوط افقی برای آجرهای رنکو
plot(renko_open, style=plot.style_stepline, color=color.red, title="Renko Open")
plot(renko_close, style=plot.style_stepline, color=color.blue, title="Renko Close")

```

---

## timeframe (series string)

بازه زمانی داده‌های درخواستی. برای درخواست داده از بازه زمانی نمودار فعلی یا بازه زمانی مشخص‌شده در تابع اندیکاتور، از یک رشته خالی یا `timeframe.period` استفاده کنید. برای درخواست داده از یک بازه زمانی دیگر، یک رشته بازه زمانی معتبر ارائه دهید. مانند: `60,1D,1W,1M`

---

## expression (variable, function, object)

عبارتی برای محاسبه و بازگرداندن مقدار از زمینه درخواستی. این عبارت می‌تواند یک متغیر داخلی مانند `close`، یک متغیر تعریف‌شده توسط کاربر، یک عبارت مانند `ta.change(close) / (high - low)`، یک فراخوانی تابع که از ترسیمات Pine Script® استفاده نمی‌کند، یک شیء، یک مجموعه یا یک ترکیب از چندین عبارت باشد.

---

## gaps (simple barmerge_gaps)

مشخص می‌کند که مقادیر بازگردانده‌شده چگونه روی میله‌های نمودار ادغام شوند. مقادیر ممکن:

- `barmerge.gaps_on`: مقدار تنها زمانی روی میله نمودار فعلی ظاهر می‌شود که برای اولین بار از زمینه تابع در دسترس باشد، در غیر این صورت مقدار `na` بازگردانده می‌شود (به این ترتیب یک "شکاف" رخ می‌دهد).
- `barmerge.gaps_off`: شکاف‌ها با آخرین مقدار شناخته‌شده پر می‌شوند، بنابراین از مقادیر `na` جلوگیری می‌شود.

این آرگومان اختیاری است و مقدار پیش‌فرض آن `barmerge.gaps_off` است.

---

## lookahead (simple barmerge_lookahead)


تنها در میله‌های تاریخی، داده‌ها را از تایم‌فریم قبل از اتمام آن بازمی‌گرداند. مقادیر ممکن:

- `barmerge.lookahead_on`: داده‌ها را از تایم‌فریم قبل از تکمیل آن بازمی‌گرداند.
- `barmerge.lookahead_off`: این رفتار را غیرفعال می‌کند.

این گزینه هیچ تاثیری بر داده‌های لحظه‌ای (realtime) ندارد. اختیاری است و مقدار پیش‌فرض از نسخه 3 `barmerge.lookahead_off` است. اما در نسخه‌های 1 و 2 پیش‌فرض `barmerge.lookahead_on` است.

⚠ هشدار: استفاده از `barmerge.lookahead_on` در تایم‌فریم‌های بالاتر از تایم‌فریم نمودار (بدون اعمال جابجایی روی آرگومان عبارت، مانند close[1]) باعث ایجاد "نشت آینده (future leak)" در اسکریپت‌ها می‌شود. در این حالت، تابع قیمت بسته شدن (close) را پیش از آن که در زمینه فعلی به‌طور واقعی در دسترس باشد، بازمی‌گرداند. همان‌طور که در صفحه Repainting در راهنمای کاربر توضیح داده شده است، این رفتار می‌تواند نتایج گمراه‌کننده‌ای ایجاد کند.

---

## ignore_invalid_symbol (input bool)

مشخص می‌کند که عملکرد تابع در صورتی که نماد مشخص‌شده پیدا نشود چگونه باشد:

- اگر مقدار `false` باشد، اسکریپت متوقف شده و یک خطای زمان اجرا (runtime error) ایجاد می‌کند.
- اگر مقدار `true` باشد، تابع مقدار na را بازمی‌گرداند و اجرای اسکریپت ادامه می‌یابد.

اختیاری است و مقدار پیش‌فرض آن `false` است.

---

## currency (series string)

واحد ارزی که مقادیر بیان‌شده در واحدهای ارزی (مانند open، high، low، close و ...) یا عبارت‌هایی که از این مقادیر استفاده می‌کنند، به آن تبدیل می‌شوند.

نرخ‌های تبدیل بر اساس نرخ‌های روزانه جفت‌های ارزی FX_IDC در روز قبل (نسبت به باری که محاسبه در آن انجام می‌شود) انجام می‌گیرد.

مقادیر ممکن:

- یک رشته سه‌حرفی که کد ارز مطابق با استاندارد ISO 4217 باشد (مانند "USD").
- یکی از مقادیر ثابت موجود در فضای نام currency.*، مانند currency.USD.

نکته: مقادیر عددی مانند 200 تبدیل نمی‌شوند.

اختیاری است و مقدار پیش‌فرض آن `syminfo.currency` است.

---

## calc_bars_count (simple int)

اگر مقدار مشخص شود، تابع فقط این تعداد مقدار را از انتهای تاریخچه نماد درخواست می‌کند و عبارت مورد نظر را طوری محاسبه می‌کند که گویی این مقادیر تنها داده‌های موجود هستند. این موضوع ممکن است در برخی موارد سرعت محاسبه را بهبود بخشد.

اختیاری است. مقدار پیش‌فرض 100,000 است، که این مقدار حداکثر محدودیت برای تمام برنامه‌های غیرحرفه‌ای TradingView می‌باشد.